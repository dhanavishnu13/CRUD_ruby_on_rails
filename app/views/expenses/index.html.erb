


<% if user_signed_in? %>
  <h1>Expenses List</h1>
  <div id="expenses"> 
    <table class="table table-striped table-bordered"> 
      <thead class="table-dark"> 
        <tr> 
          <th scope="col">Payee Name</th> 
          <th scope="col">Category</th>
          <th scope="col">Description</th> 
          <th scope="col">Amount</th>
          <th scope="col">Status</th>
          <th scope="col">Due Date</th>
          <th scope="col">Action</th> 
        </tr> 
      </thead> 
      <tbody> 
        <% @expenses.each do |expense| %>
        <% if expense.user_id==current_user.id%>
        <tr>
          <td><%= expense.payee_name %></td>
          <td><%= expense.category %></td>
          <td><%= expense.description %></td>
          <td><%= expense.amount %></td>
          <td><%= expense.status %></td>
          <td><%= expense.due_date %></td>
          <td><%= link_to "Show", expense, class:"btn btn-info"%></td>
        </tr>
        <%end%>
      <% end %>
      </tbody> 
    </table> 
    <form method="get" action="<%= expenses_path %>">
      <div class="row">
        <div class="col">
          <%= label_tag 'start_date', 'Start Date:' %>
          <%= date_field_tag 'start_date', params[:start_date] %>
        </div>

        <div class="col">
          <%= label_tag 'end_date', 'End Date:' %>
          <%= date_field_tag 'end_date', params[:end_date] %>
        </div>

        <div class="col">
          <%= submit_tag 'Apply Filter', class: 'btn btn-primary' %>
        </div>
      </div>
    </form>
    <p>Total amount: <%= @total_amount %></p>
    <% @category_amount.each do |category, sum| %>
      <p>Category: <%= category %>, Total Sum: <%= sum %></p>
    <% end %>
    <%= link_to "New expense", new_expense_path, class:"btn btn-secondary" %>
  </div>
<%else%>
    <h3>Do you want to manage your expense ?</h3>
    <h6>You are at right place! Start using MyExpense app and get ready to pay your upcoming one. </h6> 
    <%= link_to 'Sign Up Now', new_user_registration_path, class:"btn btn-primary"%>
  </div>
<%end%>

